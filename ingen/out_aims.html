<script type="text/javascript">
out_aunits = typeof pageQuery.aunits !== "undefined" ? pageQuery.aunits : "ps";
out_cunits = typeof pageQuery.cunits !== "undefined" ? pageQuery.cunits : "k";
</script>

<script type="text/javascript">
   document.write("Units of time:&nbsp;"); 
   mkUnit(out_aunits,"aunits","time");
   if (CMAT!="") { document.write("<br/>Units of energy:&nbsp;"); mkUnit(out_cunits,"cunits","nrg"); }
</script>
<br/><br/>
NB: The drift matrix <b>A</b> is output in units of the inverse of the time units given.
The diffusion matrix <b>C</b> is output the energy units given.

<script type="text/javascript">
OUTS=OUTS+DESC;
OUTS=OUTS+"# FHI-AIMS input format.  Paste into the AIMS input after the appropriate MD_run clause.\n";

if (multi_mat>0)
{
   OUTS=OUTS+"# Path integral GLE is not yet implemented in FFI-AIMS.\n# Outputting raw matrix format.\n";   
   OUTS=OUTS+"# A MATRIX: ("+unitname(out_aunits)+"^-1)\n";
   aconv=1.0/conv_i2u(1.0,out_aunits,"time");
   
   var i,j,b;
   for (b=0; b<multi_mat; ++b) 
   {
      OUTS=OUTS+"# Matrix for normal mode: " + b + "\n";      
      for (i=0; i<AMAT[b].length; ++i) 
      {  
         for (j=0; j<AMAT[b][i].length; j++)
            OUTS=OUTS+fmtReal(AMAT[b][i][j]*aconv)+" ";
         OUTS=OUTS+"\n";   
      }
   }
   
   if (CMAT != "" ) 
   {
      OUTS=OUTS+"# C MATRIX: ("+unitname(out_cunits)+")\n";
      cconv=conv_i2u(1.0,out_cunits,"nrg");
      for (b=0; b<multi_mat; ++b) 
      {
         OUTS=OUTS+"# Matrix for normal mode: " + b + "\n";      
         for (i=0; i<CMAT[b].length; ++i) 
         {  
            for (j=0; j<CMAT[b][i].length; j++)
               OUTS=OUTS+fmtReal(CMAT[b][i][j]*cconv)+" ";
            OUTS=OUTS+"\n";   
         }
      }
   }
}


else
{
   aconv=1.0/conv_i2u(1.0,out_aunits,"time");
   
   var i,j; 
   for (i=0; i<AMAT.length; ++i) 
   {  
      OUTS=OUTS+" MD_gle_A ";
      for (j=0; j<AMAT[i].length; j++)
         OUTS=OUTS+fmtReal(AMAT[i][j]*aconv)+" ";
      OUTS=OUTS+"\n";   
   }

   if (CMAT != "" ) 
   {
      OUTS=OUTS+"\n";
      cconv=conv_i2u(1.0,out_cunits,"nrg");
      for (i=0; i<CMAT.length; ++i) 
      {  
         OUTS=OUTS+" MD_gle_C ";
         for (j=0; j<CMAT[i].length; j++)
            OUTS=OUTS+fmtReal(CMAT[i][j]*cconv)+" ";
         OUTS=OUTS+"\n"; 
      }  
   }
}
OUTS=OUTS+"\n";  
</script>
